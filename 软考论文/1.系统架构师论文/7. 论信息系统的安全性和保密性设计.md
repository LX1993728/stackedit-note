&emsp;2018年2月，我参加了某市智慧城市平台项目的研发，该项目的主要目的是经过多种渠道获取该市各种突发事件和各部门数据；通过对事件的紧急处理和数据的分析产生出决策并下发指令以提高办公效率。我在项目中承担架构设计师的职务，主要负责系统的技术选型、架构设计以及部分软件设计工作。本文以其中的智慧应急系统为例，主要论述了针对该系统的安全及保密性问题，我们所采用的技术手段和解决方案。在网络上硬件层通过设置硬件防火墙，来保证内部网络安全性；在数据层通过设置数据加密和容灾备份机制，以此保证数据抗突发风险的安全性；在应用层统一采用RBAC的授权机制和程序层面安全设计来保证认证环节和业务的安全性。事实证明，以上技术方案的实现对整个系统的安全性和保密性方面起到了很好的效果，最终项目顺利上线，运行稳定得到客户的一致好评。
&emsp;随着互联网的崛起，某市响应政府的政策和号召，为了解决该城市中突发事件汇报不及时、上呈下达效率慢时间长、流程繁琐以及该市建设中不合理的隐匿问题以便更好的为人民服务；参考国外智能化城市建设的优势，决定发起智慧城市的项目。2018年2月，我司竞标该项目成功并承担了该市智慧城市项目的开发工作。该项目的主要目的是经过多种渠道获取该市各种事件信息（安保事故、消防事故、交通事故、地震、洪涝灾害等突发事件）和数据（主要是政府各职能部门如林业局，公安局，消防大队，具体涉及高铁、机场、林场、水库、公交、红绿灯、摄像头等相关设备的数据）；通过对事件的紧急处理和数据的分析产生出决策并下发指令以提高政府办公的速度，更快速更高效的解决突发事件。我在项目中担任架构设计师职务，架构小组共4人，我主要负责整体架构设计和部分软件设计，整个项目历时10个月，2018年12月顺利通过验收。
&emsp;智慧应急系统是智慧城市中最重要的系统，主要包括网格员、部委前置（各职能部门）、指挥调度中心（用于接收处理事件并下发指令）等系列服务。主要功能是通过对该市内各种紧急事件以及事故灾害的获取，统一进行分析决策，并通过下发指令的方式给相关人员进行处理。关系到该市市民的生命安全、生活交通，安全性不言而喻。特别是指令的下发如果被不法分子攻击，轻则紧急时间得不到及时处理，重则会酿成更大的事故。为了保证该系统的安全性，我在系统的安全性和保密性方面做了充分的安全设计。
&emsp;**1、网络硬件层安全方案**
&emsp;首先，因为网络和硬件是整个系统运行的基础，也是很多外部攻击的途径，所以，在这块需要进行合理规划。我们对网络拓扑结构划分为外部网络，内部网络和DMZ三部分。在外部网络和内部网络之间设置了硬件防火墙，主要防止外部的恶意攻击。在防火墙后，为了加强对并对病毒入侵的防范，我们又安装了服务器杀毒软件，实时更新最新的病毒特征库来保证有效的杀毒工具。在内部网络，我们安装了入侵检测系统IDS，通过监控系统和用户的行为并使用入侵检测分析引擎将用户行为与知识库进行匹配从而判断出是否是入侵行为；一旦判定是入侵行为，便记录证据并上报给系统和防火墙，同时触发报警给管理人员，通过入侵检测，可以及时的发现内部人员的入侵攻击。以上的防火墙和IDS都是在入侵行为发生后所做的检测和分析，时效性不高，为此我在外网和内网之间的链路上搭建入侵防御系统IPS，可以在进入内网之前实时检测入侵行为并进行阻断。为了防止外部客户端通过DNS服务直接访问我们服务器的目标地址，在内部网络中又增加了反向代理服务器，对外只暴露代理服务器的虚拟IP，更好的保护了应用服务器被攻击的可能性。应用服务器和数据库服务器做了物理隔离，内部人员也无法通过IP访问，只能通过跳板机由服务器管理员进行操作，阻断了外界通过内部客户端代理的访问对内部服务器造成攻击。对于一些核心的FTP服务器，DNS服务器，WEB服务器都规划到DMZ中。
&emsp;**2、数据层安全方案**
&emsp;其次，数据是整个系统的核心，其中涉及大量上报检举者的信息以及各种事件和事故的数据，安全性不容忽视。我主要从数据存储、数据访问和数据容灾几个方面进行了规划。由于系统主要存放了办公人员的档案数据，其中涉及很多个人隐私部分数据，为了防止泄露，我们在存储时进行了加密处理。虽然在处理中损失些性能，但是提高了数据的安全性和保密性。我们采购商业数据库Oracle作为后台存储，由于其极佳的商业口碑，对数据存储的安全提供强大保证。为了防止数据信息的泄露，加强了访问权限的限制，在数据库的访问权限上，都根据不同角色进行了详细划分，包括对数据库，表，索引，记录等的增删改查进行了限制，严格杜绝非法用户对数据库恶意破坏。同时在数据库本身也指定，也制定了基于全量，增量，差量的按周备份计划，保证每时每刻的数据都可以及时恢复。在物理存储上也做了本地多机房的容灾备份且将数据文件存储在RAID5冗余磁盘阵列，充分保证数据抗突发风险的安全。
&emsp;**3、应用层安全方案**
&emsp;最后，由于我们系统采用的是分层架构风格，同时又是采用B/A/S的形式，所以，在用户认证，接口传输等方面做了充分设计。由于涉及到政府机构不同工作类型以及职级的工作人员，角色众多，统一采用RBAC的授权机制，既增强系统安全性，满足业务需求，同时减轻由于权限信息维护带来的负担。在登陆界面设计上，不仅仅需要提供用户名+口令，同时设置了校验码，而且同时还增加了动态密令，通过短信接收验证码，以此防止暴力非法破解登陆，保证了整个系统认证环节的安全性。密码提交和存储过程中，一律采用MD5+salt加密，即使密码泄露也不会被破解。接口设计时整个系统通信的安全保障，为了防止外部人员恶意调用和窃取信息，我们采用了令牌机制保障每次通讯的安全性，即在登录后，通过加密传输的用户信息和时间戳获取到token令牌，然后在后续每次通讯传输过程中客户端都会在头信息中携带token，同时在服务端会通过拦截token并进行校验，充分保障了接口调用的安全性。
&emsp;整个项目历时10个月开发完成，从上线到目前为止运行稳定。通过客户一段时间的使用反馈，在任何环境下使用系统，均未出现信息泄露的情况。但是少数工作人员反馈，在手机登录时耗费时间较长，另外登录过程非常繁琐。经过分析登录耗费时间较长，是因为客户端在登录时需要对用户和密码信息进行客户端加密处理，加密算法耗费了移动端CPU资源，同时服务端在每次生成token也消耗不少时间。后续我们采用效率更高的加密算法以及在服务端对token进行缓存改善了此问题。
&emsp;通过实践证明，项目可以顺利上线，并稳定运行，与系统在安全性和保密性方面设计密不可分。系统安全是一个永久的话题，我们对系统的安全性设计的完善是一个持续的过程。我们接下来，还会持续不断的完善安全性设计方面的理论和经验，弥补系统安全方面的设计缺陷和不足，争取设计出更安全，质量更高的项目来。
