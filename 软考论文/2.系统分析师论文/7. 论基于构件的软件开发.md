**摘要**&emsp;2021年2月，我参与了某市智慧平台项目的研发，该项目的主要目的是通过各种渠道获取该市中各种突发事件；通过对事件的紧急处理和数据分析产生决策并下发指令以提高办公效率。涉及众多部门的业务、系统集成以及各职能部门与指挥中心的交互，旨在为政府办公提供一个更快速、更便捷、更智能化的平台。本文以该系统为例，先简单分析了CORBA、EJB、COM/DCOM三种构件技术的特点，然后着重论述了采用的构件技术进行软件开发的过程。在构件获取阶段，我们采用了三种构件获取方式来解决客户提出的三类不同的需求；在构件的开发阶段，我们统一采用了一个查询构件进行了封装，以实现将同一功能的不同表现封装到一个独立的构件中；在构件组装阶段，采用了三种构件组装方式完成了构件的组装。最终项目于2021年12月正式上线并运行稳定，得到政府各级领导的一致好评。
**项目背景**&emsp;随着互联网的崛起，某市响应政府号召，为了解决该城市中紧急事件汇报不及时、上呈下达效率慢时间长、流程繁琐以及该市中存在不合理的隐匿问题以便更好的为市民服务；参考国外智能化建设的优势，决定发起智慧城市项目。2021年我所在的单位承接了该市智慧城市平台项目的设计和开发，我在项目中担任系统架构师职位，团队由1名架构师、1名分析师以及开发测试共20名成员组成，历时10个月，于当年12月正式上线，并得到市领导的好评，该项目的主要目的是经过各个渠道获取该市各种事件信息（安保事故、消防事故、交通事故、地震、洪涝灾害等突发事件）和数据（主要是政府各职能部门如林业局、公安局、交通局、消防大队等部门以及具体涉及高铁、机场、水库、公交、红绿灯、摄像头等相关设备的数据），通过对事件的紧急处理和数据分析产生决策下发指令并监督执行过程以提高政府办公速度，更快捷、更高效的解决突发事件。对于此类涉及众多领域的项目，我和我的团队使用了基于构件的软件开发技术，极大地缩短了项目周期，并使项目按时顺利上线并稳定运行。
**技术过渡**&emsp;基于构件的软件开发是在面向对象技术的基础上发展起来的，它是软件危机问题日益突出形势下的产物，它有效的解决了软件系统复杂度、成本、质量、效率等难以控制的问题，受到业界的广泛推崇。当前主流的软件构件技术有三大流派，分别是OMG的CORBA、SUN的EJB和微软的COM技术。上述三种技术中，CORBA的实现是相对完美的，它分为对象请求代理ORB、公共对象服务和公共设施三个层次，其特点是大而全，互操作性和开放性特别好，其缺点是庞大且复杂，相关技术和标准更新缓慢。相比之下，EJB的发展要更加迅速，它是在JAVA语言基础上建立的服务端组件模型，具有优秀的跨平台性、EJB框架提供了远程访问、安全、持久化和生命周期等多种支持分布式计算的服务，目前Java和CORBA有融合的趋势。最后是COM技术，它是微软公司的独家产品。基于Windows平台，功能强大，效率很高，且有一系列相应的开发工具支持，其最大的弱点是跨平台性较差，很多人认为CORBA比COM技术走的更远。基于构件的开发技术能有效的简化设计、提高效率、保证质量。在此智慧城市平台项目的研发中，涉及领域众多，项目开发时间紧、任务重，我们使用基于构件的软件开发技术解决了软件开发中的各种问题，取得了很好的效果。
**正文**&emsp;具体在实践过程中，我们展开了模块划分、构件标识、构件获取、构件组装与测试、构件管理等活动，这里重点介绍构件获取、构件开发和构件组装的过程。
&emsp;一、构件获取
&emsp;在本系统的开发过程中，客户提出的需求从实现方式上可以分为三类。第一类需要修改当前的系统来实现，比如客户提出，需要将国外某市使用的智能决策系统集成到指挥中心系统上。第二类是直接使用我公司现成的构件来实现，比如职员登录、角色授权管理、日志记录、数据库访问、消息中间件、链路追踪工具等基本功能；第三类要集成第三方的服务来实现，比如客户要求职员办公APP软件需要有消息推送、GPS定位、短信提醒等功能。可通过集成第三方运营商的产品来实现，无需另行开发。针对以上三种类型的需求，我们采用了三种构件获取方式。首先是通过改造现有系统获取构件，我们与国外智能决策系统的开发商联系，请他们使用COM技术对软件的工作过程进行封装，并开放接口。其次是使用构件库中现成的构件，我们公司在长期的软件项目建设过程中，积累了大量可重用的软件构件，如认证授权、日志搜索等模块，这些构件可以直接在新项目中使用。最后是集成第三方的构件，针对客户提出的消息推送和GPS定位以及短信提醒功能，我们经过对比和测试，选择了飞鸽和百度的产品进行集成。此外我们还根据需求，重新开发了一些功能的构件，以支撑客户的需求。
&emsp;二、构件开发
&emsp;构件的优势体现在其粗粒度的重用性，因此在构件的设计过程中，应尽可能将同一功能的不同实现封装到一个独立的构件中，以保持高内聚、低耦合的特性，本系统的构件设计就很好地遵循了这一原则。以数据查询构件为例，整个系统中的用户需要查询的数据多种多样，对分页显示的要求不尽相同，数据返回格式也不完全一致，可能是XML，也可能是JSON，针对所有这些查询需求，我们统一用一个查询构件进行封装，开发人员只需要构造好SQL语句，再配合一些特定的参数，就能得到自己想要的结果，这样最大限度地保证了构件的可重用性和重用粒度。为了实现这一目标，有时还需使用到一些经典的设计模式。比如我们使用的数据库连接构件，就使用了抽象工厂方法，构件可以根据配置文件的内容，在运行过程中建立对不同数据库、不同方式的连接，很好地体现了构件的优势。
&emsp;三、构件的组装
&emsp;不同的构件类型，需要采用不同的组装方式。在本系统的开发过程中，我们使用到了以下三种方式。首先是DCOM构件的组装，采用了远程调用方式，该方式主要用于对智能决策系统构件的组装。其实现比较复杂，需要在智能决策系统上部署DCOM服务，还得在指挥中心的web平台的IIS上配置相应的权限。其次是构件库中构件的组装，该方式比较简单，直接引用Maven私服构件库中的产品文件，一般是Jar包的方式。最后是RPC服务调用组装，主要针对第三方的软件服务，其实现也很简单，使用基于HTTP的rest访问即可。需要注意的是这种组装方式中，由于数据需要经过第三方的软件平台进行传输，需要采用一定的数据加密措施，以提高系统的安全性。
**总结与感言**&emsp;通过使用基于构件的软件开发方式，该市智慧城市平台项目的开发工作进行的非常顺利，在时间紧任务重的情况下快速的完成了开发并顺利上线，到目前为止稳定运行，并得到了客户的一致好评。该项目的成功让我认识到好的软件设计思想和技术在软件开发过程中的作用和价值，坚定了我对基于构件的软件开发技术的信心。从软件行业的发展来看，从汇编语言、基于过程的软件开发、面向对象的软件开发，直到现在基于构件、面向服务的软件开发，我们可以认识到软件元素在两个维度上的进化趋势，即内部越来越强大、全面，对外的接口越开越简单、标准，使用起来也更便捷。通过以上实践证明，合理使用构件开发方法可以大幅度减少时间成本、降低项目风险，对项目的顺利进行起到了至关重要的作用。作为本项目的系统架构师，我会吸取这次的经验，在后续系统开发中发挥开发方式的优势，为公司创造利益的同时，也为客户开发出更优秀的系统。