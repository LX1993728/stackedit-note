**摘要**&emsp;2021年2月，我参与了某市智慧城市平台项目的研发，该项目的主要目的是经过各种渠道获取该市各种突发事件；通过对事件的紧急处理和数据分析决策并下发指令以提高办公效率。涉及众多部门的业务、系统集成以及与指挥中心的交互，旨在为政府办公提供一个更快速、更便捷、更智能化的平台。由于政府的项目通常有较长的维护周期，并且有效的控制维护成本和维护风险，因此需要采用多种措施来提高软件的可维护性。本文以该项目的实践为例，讨论了软件维护的三种类型，正确性维护、预防性维护和完善性维护的特点，阐明了影响软件可维护性的三个主要因素，即分析阶段尽可能的模块化设计，高内聚，低耦合；缺陷预防需要新技术新工具的支撑；变更控制要通过UCM方式进行闭环管理。本文结合项目的开发过程，详细介绍了在项目中所进行的软件维护活动，为提高软件可维护性所采取的措施，并基于这些评价了实施过程中的效果。最后总结了项目在软件维护及可维护方面取得的成绩和需要改进的地方。
**项目背景**&emsp;随着互联网的崛起，某市响应政府的号召，为了解决该城市中冲突事件汇报不及时、上呈下达效率慢时间长、流程繁琐以及该城市建设中存在不合理的隐匿问题以便更好的为市民服务；参考国外智能化建设的优势，决定发起智慧城市项目。2021年2月，我所在的单位承接了某市智慧城市平台项目的开发与设计，我在项目中担任系统分析师职位，团队由1名架构师，1名分析师以及开发测试共20名成员组成，历史10个月，于当年12月正式上线，并得到市领导的好评。该项目的主要目的是经过各种渠道获取该市各种事件信息（安保事故、消防事故、交通事故、地震、洪涝灾害等突发事件）和数据（主要是政府各职能部门如林业局、公安局，交通局，消防大队各个部门以及具体涉及高铁、机场、水库、公交、红绿灯、监控摄像等相关设备的数据）；通过对事件的紧急处理和数据分析产生决策并下发指令并监督执行过程以提高政府办公速度，更快捷、更高效的解决突发事件。该类系统通常生命周期较长，尤其是软件的维护周期较长，往往还需要一个小型团队专门进行项目的维护工作。为了能够有效控制维护成本，提高软件的可维护性，我们在团队开发过程中采取了一系列方法措施。下面我将详细论述这些方法措施在软件维护方面的作用和意义。
**技术过渡**&emsp;通常比较常见的软件维护类型有：正确性维护、预防性维护和完善性维护。一般来说，正确性维护即修改软件交付后发现的缺陷，主要通过修复后的新版本、修复脚本或修复补丁等方式。预防性维护是指在软件开发过程中预防缺陷的产生，是一种防患于未然的措施，正确地进行缺陷预防，能够很好的降低软件的开发维护成本。完善性维护是指由于用户在使用软件的过程中，业务需求发生了变化，因而需要对软件系统功能进行变更的一种维护，这种维护手段不仅要求软件自身有较好的扩展性，同时也要求从管理的角度做好变更的跟踪和控制。
**正文**&emsp;我认为影响软件可维护性的主要因素有三点，首先，系统在分析设计阶段是否很好地遵循了规范，有没有使用成熟可靠的通用构件，系统架构是否扩展性强，模块设计是否高内聚、低耦合；其次，缺陷预防的投入是否足够，有没有使用新技术、新工具来提高效率和质量；再次，变更控制管理是否到位，有没有做到问题闭环管理，对于代码的修改是否有评审监控，对于修改后的版本是否有效管理。我们在实际开发中使用了多种设计规范、技术手段、管理手段来落实以上三点。
&emsp;1、尽可能的采用合适的设计方式、稳定的通用构件来增强系统的可靠性、可维护性和可扩展性。在本项目架构设计时，我们考虑到涉及多个职能部门的异构系统对接以及与指挥调度中心的交互带来的通信组件协议和数据格式不统一，性能参差不齐，存在同一业务涉及多种异构项目的改动会对开发以及后期的维护带来很大困难的问题，我们采用微服务的方式将各个异构系统封装为一个个微服务，通过统一的轻量级RPC通信的方式进行交互，可以极大的缩减在开发和维护方面的成本开销，其次在涉及接入大的系统时采用按照具体场景拆分为多个微服务，分批分类进行打包编译以及部署，只有与变更相关的微服务才会被重新编译打包部署，即减少了开发过程中的代码冲突的同时也减少了部署上线的时间，间接的减少了维护成本。在开发过程中，为了达到高内聚、低耦合以通过保证单一职责来提高可扩展性，我们采用了领域驱动设计的方式并配合成熟的RocketMQ中间件来进行具体的场景设计和实现，与传统的三层代码模型（即控制器，service，Dao）不同的是，DDD不仅仅使用面向对象进行设计开发，在此基础上抽取出了领域的概念，领域根据具体情况可以划分不同类型的子域，通过领域战略设计中的事件风暴划分出子域对应的限界上下文(微服务)以及限界上下文中的聚合来确定服务的物理边界以及服务内的代码边界；通过战术设计在编码过程中确定聚合内的充血模型、领域服务、应用服务之间的编码规范；通过DDD的战略设计和战术设计可以很好的保证代码的职责单一性，保证了高内聚和低耦合，同时也为微服务的拆分提供了方针。例如当服务内的某个聚合迭代过于频繁，可以独立拆分出去自成一个微服务单独维护，直接将整个聚合包转移出去，相对于各种service的相互关联更方便，改动更小，对于服务的演化以及项目的迭代和维护带来了很大的便利。
&emsp;2、使用新技术、新工具进行缺陷预防。我们认为在软件开发过程中有效的缺陷预防胜于疲于奔命的缺陷修复，因此我们引入了一系列新技术、新工具来进行缺陷预防。首先推行持续集成技术，即采用Jenkins持续集成引擎，每隔10分钟就基于SCM检查是否提交了新代码并进行构建，并自动执行单元测试用例，每隔2个小时就执行一次集成测试用例、代码静态结构分析和代码覆盖率分析，并将结果通过邮件发送给项目成员。其次优化开发人员的集成开发工具，（1）使用Junit做单元测试。（2）使用Emma做代码覆盖率测试（3）使用FindBugs和PMD做代码静态结构分析（4）使用CheckStyle做代码规范检查，与此同时测试人员使用EasyB和Selenium来开发自动化回归测试用例，并将其与Jenkins引擎集成，质量控制人员使用Sonar对代码质量、规模和设计进行度量。这样就可以使团队从多个角度对项目质量把关，进而使整个系统的设计、开发、集成、测试过程透明可见，真正的做到了让项目在 "阳光" 下进行，从而有效的达到了进行缺陷预防的目的，极大地降低了缺陷逃逸率。但是另一方面，有的成员会抱怨因太多的检查预防措施耽误了开发进度，连项目经理也会有相同的顾虑。我通过对比历史项目，没有经过基本的预防检查，表面看似很快却在测试阶段搁浅，并反复回归，以至于模块、代码千疮百孔，甚至上线后发现了严重的缺陷，造成公司拟公司和客户的损失，才最终将其说服并严格做好了后面的缺陷预防规范工作，正是由于我们的项目在开发过程中就打下了坚实的基础，才保证了在验收和试运行时是无障碍的，收到客户好评。
&emsp;3、使用UCM变更控制，我们在项目开发过程中使用IBM Rational ClearCase和ClearRequest对变更和缺陷进行UCM管理。在项目维护期，闭环变更和缺陷管理显得尤为重要。所谓的UCM是指客户提出的变更申请和缺陷进行统一管理，包括分类，优先级评定和状态跟踪等。在我们项目中，客户通过ClearRequest提出变更请求，待项目经理及变更委员会批准后，新需求会分配给相应的开发人员。开发人员只可以根据ClearRequest的任务迁出相应模块的程序代码进行修改，而对于其它不相关的代码，它们则无权访问。开发人员完成代码修改和提交后，变更请求流转测试人员处进行复测和回归测试，最后经用户确认后，才发版发布部署。整个过程可管理、可跟踪、有记录并与版本控制系统无缝集成。
**总结与感言**&emsp;综上所述，我们在项目开发过程中采用合适的设计方式、通用的构件、并引入新技术、新工具进行缺陷预防，同时结合UCM变更控制管理等一系列手段来提高系统的可维护性，有效地降低了软件维护难度和维护成本。自系统上线至今未发现任何严重缺陷，系统稳定可靠，得到了客户和公司领导的肯定。同时我也发现了一些不足之处，例如，如何平衡缺陷预防、质量控制和项目进度的关系。我相信我和我的团队会在不断尝试中解决好这一问题，我今后也会更加努力提高专业技术水平，为我国的软件事业贡献自己的力量。